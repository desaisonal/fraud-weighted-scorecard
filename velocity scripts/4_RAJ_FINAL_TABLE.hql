SET hive.stats.autogather=false;
SET hive.exec.compress.output=true; 
SET mapred.output.compression.codec=org.apache.hadoop.io.compress.SnappyCodec; 
SET mapred.output.compression.type=BLOCK;
SET hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;

USE gfora;

DROP TABLE RAJ_FINAL_TABLE;

CREATE TABLE RAJ_FINAL_TABLE
ROW FORMAT DELIMITED
STORED AS SEQUENCEFILE
AS

SELECT
 a.fraudtransaction_fraudtransactionid AS FRAUD_TRANSACTION_ID
,a.fraudtransaction_iscompletedbooking AS ISCOMPLETED_BOOKING
,a.fraudtransaction_trl AS TRL
,a.ITEM_AMOUNT_LOCAL
,a.ITEM_AMOUNT_USD_DERIVED
,a.ITEM_CURRENCY_CODE
,a.PRODUCT_ITEM_COUNT
,a.TRAVELER_PHONE_NUMBER_COUNT
,a.TRAVELER_IS_ANY_GIVEN_NAME_LOWER_CASE
,a.TRAVELER_IS_ANY_GIVEN_NAME_UPPER_CASE
,a.TRAVELER_IS_ANY_SURNAME_LOWER_CASE
,a.TRAVELER_IS_ANY_SURNAME_UPPER_CASE
,a.PAYMENT_ITEM_COUNT
,b.TRAVELER_EMAIL_ADDRESS_1
,b.TRAVELER_EMAIL_ADDRESS_2
,b.TRAVELER_EMAIL_ADDRESS_3
,b.TRAVELER_EMAIL_ADDRESS_4
,b.TRAVELER_EMAIL_ADDRESS_5 
,c.TRAVELER_FULL_NAME_DERIVED_1
,c.TRAVELER_GIVEN_NAME_1
,c.TRAVELER_MIDDLE_NAME_1
,c.TRAVELER_LAST_NAME_1
,c.TRAVELER_GENDER_NAME_1	 
,c.TRAVELER_IS_PRIMARY_1
,c.TRAVELER_IS_GIVEN_NAME_LOWER_CASE_1
,c.TRAVELER_IS_GIVEN_NAME_UPPER_CASE_1
,c.TRAVELER_IS_SURNAME_LOWER_CASE_1
,c.TRAVELER_IS_SURNAME_UPPER_CASE_1
,c.TRAVELER_FULL_NAME_DERIVED_2
,c.TRAVELER_GIVEN_NAME_2
,c.TRAVELER_MIDDLE_NAME_2
,c.TRAVELER_LAST_NAME_2
,c.TRAVELER_GENDER_NAME_2	 
,c.TRAVELER_IS_PRIMARY_2
,c.TRAVELER_IS_GIVEN_NAME_LOWER_CASE_2
,c.TRAVELER_IS_GIVEN_NAME_UPPER_CASE_2
,c.TRAVELER_IS_SURNAME_LOWER_CASE_2
,c.TRAVELER_IS_SURNAME_UPPER_CASE_2
,c.TRAVELER_FULL_NAME_DERIVED_3
,c.TRAVELER_GIVEN_NAME_3
,c.TRAVELER_MIDDLE_NAME_3
,c.TRAVELER_LAST_NAME_3
,c.TRAVELER_GENDER_NAME_3	 
,c.TRAVELER_IS_PRIMARY_3
,c.TRAVELER_IS_GIVEN_NAME_LOWER_CASE_3
,c.TRAVELER_IS_GIVEN_NAME_UPPER_CASE_3
,c.TRAVELER_IS_SURNAME_LOWER_CASE_3
,c.TRAVELER_IS_SURNAME_UPPER_CASE_3
,c.TRAVELER_FULL_NAME_DERIVED_4
,c.TRAVELER_GIVEN_NAME_4
,c.TRAVELER_MIDDLE_NAME_4
,c.TRAVELER_LAST_NAME_4
,c.TRAVELER_GENDER_NAME_4 
,c.TRAVELER_IS_PRIMARY_4
,c.TRAVELER_IS_GIVEN_NAME_LOWER_CASE_4
,c.TRAVELER_IS_GIVEN_NAME_UPPER_CASE_4
,c.TRAVELER_IS_SURNAME_LOWER_CASE_4
,c.TRAVELER_IS_SURNAME_UPPER_CASE_4
,c.TRAVELER_FULL_NAME_DERIVED_5
,c.TRAVELER_GIVEN_NAME_5
,c.TRAVELER_MIDDLE_NAME_5
,c.TRAVELER_LAST_NAME_5
,c.TRAVELER_GENDER_NAME_5	 
,c.TRAVELER_IS_PRIMARY_5
,c.TRAVELER_IS_GIVEN_NAME_LOWER_CASE_5
,c.TRAVELER_IS_GIVEN_NAME_UPPER_CASE_5
,c.TRAVELER_IS_SURNAME_LOWER_CASE_5
,c.TRAVELER_IS_SURNAME_UPPER_CASE_5
,d.TRAVELER_BUSINESS_PHONE_DERIVED_1
,d.TRAVELER_BUSINESS_PHONE_AREA_CODE_1
,d.TRAVELER_BUSINESS_PHONE_COUNTRY_ACCESS_CODE_1
,d.TRAVELER_BUSINESS_PHONE_NUMBER_1
,d.TRAVELER_BUSINESS_PHONE_DERIVED_2
,d.TRAVELER_BUSINESS_PHONE_AREA_CODE_2
,d.TRAVELER_BUSINESS_PHONE_COUNTRY_ACCESS_CODE_2
,d.TRAVELER_BUSINESS_PHONE_NUMBER_2
,d.TRAVELER_BUSINESS_PHONE_DERIVED_3
,d.TRAVELER_BUSINESS_PHONE_AREA_CODE_3
,d.TRAVELER_BUSINESS_PHONE_COUNTRY_ACCESS_CODE_3
,d.TRAVELER_BUSINESS_PHONE_NUMBER_3
,d.TRAVELER_BUSINESS_PHONE_DERIVED_4
,d.TRAVELER_BUSINESS_PHONE_AREA_CODE_4
,d.TRAVELER_BUSINESS_PHONE_COUNTRY_ACCESS_CODE_4
,d.TRAVELER_BUSINESS_PHONE_NUMBER_4
,d.TRAVELER_BUSINESS_PHONE_DERIVED_5
,d.TRAVELER_BUSINESS_PHONE_AREA_CODE_5
,d.TRAVELER_BUSINESS_PHONE_COUNTRY_ACCESS_CODE_5
,d.TRAVELER_BUSINESS_PHONE_NUMBER_5
,e.TRAVELER_HOME_PHONE_DERIVED_1
,e.TRAVELER_HOME_PHONE_AREA_CODE_1
,e.TRAVELER_HOME_PHONE_COUNTRY_ACCESS_CODE_1
,e.TRAVELER_HOME_PHONE_NUMBER_1	 
,e.TRAVELER_HOME_PHONE_DERIVED_2
,e.TRAVELER_HOME_PHONE_AREA_CODE_2
,e.TRAVELER_HOME_PHONE_COUNTRY_ACCESS_CODE_2
,e.TRAVELER_HOME_PHONE_NUMBER_2
,e.TRAVELER_HOME_PHONE_DERIVED_3
,e.TRAVELER_HOME_PHONE_AREA_CODE_3
,e.TRAVELER_HOME_PHONE_COUNTRY_ACCESS_CODE_3
,e.TRAVELER_HOME_PHONE_NUMBER_3
,e.TRAVELER_HOME_PHONE_DERIVED_4
,e.TRAVELER_HOME_PHONE_AREA_CODE_4
,e.TRAVELER_HOME_PHONE_COUNTRY_ACCESS_CODE_4
,e.TRAVELER_HOME_PHONE_NUMBER_4
,e.TRAVELER_HOME_PHONE_DERIVED_5
,e.TRAVELER_HOME_PHONE_AREA_CODE_5
,e.TRAVELER_HOME_PHONE_COUNTRY_ACCESS_CODE_5
,e.TRAVELER_HOME_PHONE_NUMBER_5
,f.TRAVELER_MOBILE_PHONE_DERIVED_1
,f.TRAVELER_MOBILE_PHONE_AREA_CODE_1
,f.TRAVELER_MOBILE_PHONE_COUNTRY_ACCESS_CODE_1
,f.TRAVELER_MOBILE_PHONE_NUMBER_1	 
,f.TRAVELER_MOBILE_PHONE_DERIVED_2
,f.TRAVELER_MOBILE_PHONE_AREA_CODE_2
,f.TRAVELER_MOBILE_PHONE_COUNTRY_ACCESS_CODE_2
,f.TRAVELER_MOBILE_PHONE_NUMBER_2
,f.TRAVELER_MOBILE_PHONE_DERIVED_3
,f.TRAVELER_MOBILE_PHONE_AREA_CODE_3
,f.TRAVELER_MOBILE_PHONE_COUNTRY_ACCESS_CODE_3
,f.TRAVELER_MOBILE_PHONE_NUMBER_3
,f.TRAVELER_MOBILE_PHONE_DERIVED_4
,f.TRAVELER_MOBILE_PHONE_AREA_CODE_4
,f.TRAVELER_MOBILE_PHONE_COUNTRY_ACCESS_CODE_4
,f.TRAVELER_MOBILE_PHONE_NUMBER_4
,f.TRAVELER_MOBILE_PHONE_DERIVED_5
,f.TRAVELER_MOBILE_PHONE_AREA_CODE_5
,f.TRAVELER_MOBILE_PHONE_COUNTRY_ACCESS_CODE_5
,f.TRAVELER_MOBILE_PHONE_NUMBER_5
FROM

gfora.FINAL_TABLE_1 a

INNER JOIN
gfora.MODEL_DETAIL_EMAIL_DRV b
ON
a.fraudtransaction_fraudtransactionid = b.FRAUD_TRANSACTION_ID

INNER JOIN
gfora.MODEL_DETAIL_TRAVELERNAME_DRV c
ON
a.fraudtransaction_fraudtransactionid = b.FRAUD_TRANSACTION_ID

INNER JOIN
gfora.MODEL_DETAIL_BUSINESSPHONE_DRV d
ON
a.fraudtransaction_fraudtransactionid = c.FRAUD_TRANSACTION_ID

INNER JOIN
gfora.MODEL_DETAIL_HOMEPHONE_DRV e
ON
a.fraudtransaction_fraudtransactionid = d.FRAUD_TRANSACTION_ID

INNER JOIN
gfora.MODEL_DETAIL_MOBILEPHONE_DRV f
ON
a.fraudtransaction_fraudtransactionid = e.FRAUD_TRANSACTION_ID
;
